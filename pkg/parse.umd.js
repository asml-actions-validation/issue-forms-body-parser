!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("unified"),require("remark-parse"),require("remark-gfm"),require("@sindresorhus/slugify"),require("remark-stringify"),require("strip-final-newline"),require("debug"),require("date-fns"),require("date-fns-tz")):"function"==typeof define&&define.amd?define(["unified","remark-parse","remark-gfm","@sindresorhus/slugify","remark-stringify","strip-final-newline","debug","date-fns","date-fns-tz"],n):(e||self).issueFormsBodyParser=n(e.unified,e.remarkParse,e.remarkGfm,e.slugify,e.remarkStringify,e.stripFinalNewline,e.debug,e.dateFns,e.dateFnsTz)}(this,function(e,n,t,r,i,u,a,o,f){function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d=/*#__PURE__*/l(n),s=/*#__PURE__*/l(t),c=/*#__PURE__*/l(r),h=/*#__PURE__*/l(i),m=/*#__PURE__*/l(u),y=/*#__PURE__*/l(a);function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var v=["yyyy-MM-dd","dd/MM/yyyy","dd/MM/yy","dd-MM-yyyy","dd-MM-yy","dd.MM.yyyy","dd.MM.yy"],g=["HH:mm","HH.mm","hh:mm aaa","hh:mm a..aa","hh:mm aaaa"],b=function e(n){return n.children.map(function(t){var r={};return"list"===t.type?e(n):"listItem"===t.type?(r.checked=t.checked,t.children.map(function(e){if("paragraph"===e.type)return r.text=e.children.map(function(e){return"link"===e.type?(r.link=e.url,"["+e.children[0].value+"]("+e.url+")"):e.value}).filter(function(e){return!!e}).join(""),r}).filter(function(e){return!!e})):void 0}).filter(function(e){return!!e})};function k(e,n,t){if(!e.s){if(t instanceof M){if(!t.s)return void(t.o=k.bind(null,e,n));1&n&&(n=t.s),t=t.v}if(t&&t.then)return void t.then(k.bind(null,e,n),k.bind(null,e,2));e.s=n,e.v=t;var r=e.o;r&&r(e)}}var M=/*#__PURE__*/function(){function e(){}return e.prototype.then=function(n,t){var r=new e,i=this.s;if(i){var u=1&i?n:t;if(u){try{k(r,1,u(this.v))}catch(e){k(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?k(r,1,n?n(i):i):t?k(r,1,t(i)):k(r,2,i)}catch(e){k(r,2,e)}},r},e}();function x(e){return e instanceof M&&1&e.s}var w=y.default("body-parser");return function(n){try{var t,r,i,u,a,l,y,T,q,j,I,O,S,A,H;return w("parseMD()"),Promise.resolve(e.unified().use(d.default).use(s.default).parse(n)).then(function(n){function d(){for(S in U)(H=(A=U[S]).content.filter(Boolean))&&H.length>0&&(1===H.length&&(A.text=H[0]),A.text=H.join("\n\n")),A.content=H;return U}if(!n)return[];var U={},z=null;t=function(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return p(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?p(e,n):void 0}}(e))){t&&(e=t);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n.children);var P=function(e,n,t){for(var r;;){var i=e();if(x(i)&&(i=i.v),!i)return u;if(i.then){r=0;break}var u=t();if(u&&u.then){if(!x(u)){r=1;break}u=u.s}if(n){var a=n();if(a&&a.then&&!x(a)){r=2;break}}}var o=new M,f=k.bind(null,o,2);return(0===r?i.then(d):1===r?u.then(l):a.then(s)).then(void 0,f),o;function l(r){u=r;do{if(n&&(a=n())&&a.then&&!x(a))return void a.then(s).then(void 0,f);if(!(i=e())||x(i)&&!i.v)return void k(o,1,u);if(i.then)return void i.then(d).then(void 0,f);x(u=t())&&(u=u.v)}while(!u||!u.then);u.then(l).then(void 0,f)}function d(e){e?(u=t())&&u.then?u.then(l).then(void 0,f):l(u):k(o,1,u)}function s(){(i=e())?i.then?i.then(d).then(void 0,f):d(i):k(o,1,u)}}(function(){return!(r=t()).done},void 0,function(){return i=r.value,Promise.resolve(e.unified().use(s.default).use(h.default).stringify(i)).then(function(e){var n,t;(u=m.default(e)).indexOf("\\_")>-1&&(u=u.replace(/\\_/g,"_")),"heading"===i.type?(z=c.default(i.children[0].value),U[z]={title:i.children[0].value,heading:i.depth,content:[]}):"paragraph"===i.type&&z?(a=U[z],n=u,t=v.map(function(e){return o.isMatch(n,e)}),l=t.indexOf(!0)>-1?f.zonedTimeToUtc(o.parse(n,v[t.indexOf(!0)],new Date),"UTC").toJSON().split("T")[0]:null,y=i.children.filter(function(e){return"image"===e.type}).map(function(e){return{src:e.url,alt:e.alt}}),T=i.children.filter(function(e){return"link"===e.type}).map(function(e){return{src:e.url,alt:e.children[0].value}}),q=function(e){var n=g.map(function(n){return o.isMatch(e,n)});if(n.indexOf(!0)>-1){var t=f.zonedTimeToUtc(o.parse(e,g[n.indexOf(!0)],new Date),"UTC");return f.formatInTimeZone(t,"UTC","HH:mm")}return null}(u),j=function(e){var n=!1,t={hours:0,minutes:0},r=new RegExp(/([0-9]+)h([0-9]+)m/),i=new RegExp(/([0-9]+)h/);if(e.match(r)){n=!0;var u=e.match(r),a=u[2];t.hours=parseInt(u[1]),t.minutes=parseInt(a)}else if(e.match(i)){n=!0;var o=e.match(i);t.hours=parseInt(o[1]),t.minutes=0}return n?t:null}(u),l&&(a.date=l),q&&(a.time=q),j&&(a.duration=j),T&&T.length>0&&(a.links=T),y&&y.length>0&&(a.images=y),a.content.push(u)):"list"===i.type?((I=U[z]).text=u,I.list=b(i).flat()):"html"===i.type?U[z].content.push(i.html):"code"===i.type?((O=U[z]).lang=i.lang,O.text=u):(w("unhandled token type"),w(i))})});return P&&P.then?P.then(d):d()})}catch(e){return Promise.reject(e)}}});
//# sourceMappingURL=parse.umd.js.map
